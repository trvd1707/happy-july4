{"version":3,"sources":["ifr-visualizer/AnchoredTargetVisualizer.js"],"names":[],"mappings":"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","file":"ifr-visualizer/AnchoredTargetVisualizer.js","sourcesContent":["/**\n * @author jg\n * Copyright 2016 IF Robots LLC\n */\n\n\"use strict\";\n\nvar THREE = require(\"three\");\nvar GLLinePool = require(\"./GLLinePool\");\n\n/**\n *\n * @param {THREE.Vector3} groundPlaneNormal\n * @constructor\n */\nvar AnchoredTargetVisualizer = function(groundPlaneNormal){\n\n\t/**\n\t * @type {THREE.Vector3}\n\t * @private\n\t */\n\tthis._groundPlaneNormal = groundPlaneNormal;\n\n\t/**\n\t * @type {?THREE.Vector3}\n\t * @private\n\t */\n\tthis._target = null;\n\n\t/**\n\t * @type {GLLinePool}\n\t * @private\n\t */\n\tthis._linePool = null;\n\n\t/**\n\t * @function\n\t * @private\n\t */\n\tthis._renderCallback = null;\n\n\t/**\n\t * @type {number}\n\t * @private\n\t */\n\tthis._lineWidth = 1;\n\n\t/**\n\t * @type {number}\n\t * @private\n\t */\n\tthis._brightness = 1;\n\n\t/**\n\t * @type {THREE.Color}\n\t * @private\n\t */\n\tthis._baseColor = new THREE.Color(1,0,1);\n};\n\n/**\n * @param {THREE.Vector3} position\n */\nAnchoredTargetVisualizer.prototype.setPosition = function(position){\n\tif(this._target === null && position !== null){\n\t\tthis._target = new THREE.Vector3(position.x, position.y, position.z);\n\t}else if(position == null){\n\t\tthis._target = null;\n\t}else{\n\t\tthis._target.copy(position);\n\t}\n};\n\n/**\n * Install a renderer into scene that will draw this target.\n *\n * @param {BasicScene} scene\n */\nAnchoredTargetVisualizer.prototype.installRendererIntoScene = function(scene){\n\tif(this._linePool!=null || this._renderCallback!=null){\n\t\tthrow new Error(\"Remove VTP renderer from existing scene before installing in another!\");\n\t}\n\n\tthis._linePool = new GLLinePool(scene, 10);\n\n\tvar self = this;\n\n\tthis._renderCallback = function(){\n\t\tif(self._target != null) {\n\t\t\tvar target = self._target;\n\t\t\tvar brightness = self._brightness;\n\t\t\tvar baseColor = self._baseColor;\n\t\t\tself._linePool.setLineWidth(self._lineWidth);\n\n\t\t\tvar scale = 0.05;\n\t\t\tself._linePool.drawOnce(new THREE.Vector3().copy(target).add(new THREE.Vector3(scale, 0, 0)), new THREE.Vector3().copy(target).sub(new THREE.Vector3(scale, 0, 0)), new THREE.Color(1 * brightness, 0, 0));\n\t\t\tself._linePool.drawOnce(new THREE.Vector3().copy(target).add(new THREE.Vector3(0, scale, 0)), new THREE.Vector3().copy(target).sub(new THREE.Vector3(0, scale, 0)), new THREE.Color(0, 1 * brightness, 0));\n\t\t\tself._linePool.drawOnce(new THREE.Vector3().copy(target).add(new THREE.Vector3(0, 0, scale)), new THREE.Vector3().copy(target).sub(new THREE.Vector3(0, 0, scale)), new THREE.Color(0.2 * brightness, 0.2 * brightness, 1 * brightness));\n\n\t\t\tvar groundTarget = new THREE.Vector3().copy(target).projectOnPlane(self._groundPlaneNormal);\n\t\t\tself._linePool.drawOnce(new THREE.Vector3().copy(groundTarget).add(new THREE.Vector3(scale, scale, 0)), new THREE.Vector3().copy(groundTarget).sub(new THREE.Vector3(scale, scale, 0)), new THREE.Color(baseColor.r * brightness, baseColor.g * brightness, baseColor.b * brightness));\n\t\t\tself._linePool.drawOnce(new THREE.Vector3().copy(groundTarget).add(new THREE.Vector3(scale, -scale, 0)), new THREE.Vector3().copy(groundTarget).sub(new THREE.Vector3(scale, -scale, 0)), new THREE.Color(baseColor.r * brightness, baseColor.g * brightness, baseColor.b * brightness));\n\n\t\t\tself._linePool.drawOnce(groundTarget, target, new THREE.Color(baseColor.r * brightness, baseColor.g * brightness, baseColor.b * brightness));\n\t\t}\n\t};\n\n\tscene.addRenderCallback(this._renderCallback);\n};\n\n/**\n * Remove the renderer from this scene.\n *\n * @param {BasicScene} scene\n */\nAnchoredTargetVisualizer.prototype.removeRendererFromScene = function(scene){\n\tif(this._linePool != null) {\n\t\tthis._linePool.removeFromScene(scene);\n\t}\n\tif(this._renderCallback!=null) {\n\t\tscene.removeRenderCallback(this._renderCallback);\n\t}\n\n\tthis._linePool = null;\n\tthis._renderCallback = null;\n};\n\n/**\n * @param {number} width\n */\nAnchoredTargetVisualizer.prototype.setLineWidth = function(width){\n\tthis._lineWidth = width;\n};\n\n/**\n * @param {number} brightness\n */\nAnchoredTargetVisualizer.prototype.setBrightness = function(brightness){\n\tthis._brightness = brightness;\n};\n\n/**\n * @param {THREE.Color} baseColor\n */\nAnchoredTargetVisualizer.prototype.setBaseColor = function(baseColor){\n\tthis._baseColor.set(baseColor);\n};\n\n\nmodule.exports = AnchoredTargetVisualizer;"],"sourceRoot":"/source/"}