{"version":3,"sources":["ifr-motion/base/Motion.js"],"names":[],"mappings":"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","file":"ifr-motion/base/Motion.js","sourcesContent":["/**\n * @author mattb\n * Copyright 2015 IF Robots LLC\n */\n\n\"use strict\";\n\nvar Pose = require(\"./Pose\");\nvar MotionTrack = require(\"./MotionTrack\");\nvar TimestampedBuffer = require(\"./TimestampedBuffer\");\n\n/**\n * @param {string} name\n * @constructor\n */\nvar Motion = function(name)\n{\n\t/** @type {string} */\n\tthis.name = name;\n\t/** @type {number} */\n\tthis.length = 0;\n\t/** @type {Object.<string, MotionTrack>} */\n\tthis.tracks = {};\n};\n\n/**\n * @return {string}\n */\nMotion.prototype.getName = function()\n{\n\treturn this.name;\n};\n\n/**\n * @return {number} duration of the motion in seconds\n */\nMotion.prototype.getDuration = function()\n{\n\treturn this.length;\n};\n\n/**\n * @return {Object.<string, MotionTrack>}\n */\nMotion.prototype.getTracks = function()\n{\n\treturn this.tracks;\n};\n\n/**\n * add a track to this motion\n * @param {MotionTrack} track\n */\nMotion.prototype.addTrack = function(track)\n{\n\tthis.tracks[track.getName()] = track;\n\tif (track.getLength() > this.length)\n\t{\n\t\tthis.length = track.getLength();\n\t}\n};\n\n/**\n * get pose data for this motion at the specified time\n * @param {number} time\n * @param {InterpolatorSet} interpolatorSet DOF interpolators to use\n * @param {Pose} [inplacePose] if specified, store the result in this pose\n * @return {Pose} the requested pose data (inplacePose if specified)\n */\nMotion.prototype.getPoseAtTime = function(time, interpolatorSet, inplacePose)\n{\n\tif (inplacePose === undefined || inplacePose === null)\n\t{\n\t\tinplacePose = new Pose(this.getName()+\" pose sample\", Object.keys(this.tracks));\n\t}\n\n\tif (typeof time !== 'number'){\n\t\tthrow new Error(\"getPoseAtTime expects time as a number value in seconds\");\n\t}\n\n\tvar dofNames = inplacePose.getDOFNames();\n\tfor (var dofIndex=0; dofIndex<dofNames.length; dofIndex++)\n\t{\n\t\tvar dofName = dofNames[dofIndex];\n\t\tif (this.tracks.hasOwnProperty(dofName))\n\t\t{\n\t\t\tvar interpolator = interpolatorSet.getInterpolator(dofName);\n\t\t\tif (interpolator === null)\n\t\t\t{\n\t\t\t\tthrow new Error(\"no interpolator provided for DOF name: \"+dofName);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvar sample = this.tracks[dofName].getDataAtTime(time, interpolator);\n\t\t\t\tif (sample !== null)\n\t\t\t\t{\n\t\t\t\t\tinplacePose.set(dofName, sample);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn inplacePose;\n};\n\n/**\n * Convenience constructor to make a static \"Motion\" from a single pose.\n * Motion will have 1 keyframe at zero, and duration of passed in duration value.\n * Motion will have the dofs onDOFs if provided, otherwise will have all the\n * dofs present in pose.\n *\n * @param {string} name\n * @param {Pose} pose\n * @param {number} duration\n * @param {string[]} [onDOFs] - use only these DOFs (Defaults to all dofs in pose)\n * @return {Motion}\n */\nMotion.createFromPose = function(name, pose, duration, onDOFs){\n\tvar motion = new Motion(name);\n\n\tif(onDOFs == null){ //null or undefined (eqnull)\n\t\tonDOFs = pose.getDOFNames();\n\t}\n\n\tfor (var i = 0; i < onDOFs.length; i++) {\n\t\tvar dofName = onDOFs[i];\n\t\tvar value = pose.get(dofName);\n\t\tvar dataNew = new TimestampedBuffer();\n\t\tdataNew.append(0, value);\n\t\tmotion.addTrack(new MotionTrack(dofName, dataNew, duration));\n\t}\n\n\treturn motion;\n};\n\n/**\n * Convenience constructor to make a \"Motion\" from a series of poses.\n * Motion will have a keyframe at each time in times, and duration of passed in duration value.\n * Motion will have the dofs onDOFs if provided, otherwise will have all the\n * dofs present in the first pose in poses.\n *\n * @param {string} name\n * @param {Pose[]} poses\n * @param {number[]} times\n * @param {number} duration\n * @param {string[]} [onDOFs] - use only these DOFs (Defaults to all dofs in pose)\n * @return {Motion}\n */\nMotion.createFromPoses = function(name, poses, times, duration, onDOFs){\n\tvar motion = new Motion(name);\n\n\tif(onDOFs == null){ //null or undefined (eqnull)\n\t\tonDOFs = poses[0].getDOFNames();\n\t}\n\n\tfor (var i = 0; i < onDOFs.length; i++) {\n\t\tvar dofName = onDOFs[i];\n\t\tvar dataNew = new TimestampedBuffer();\n\t\tfor(var j = 0; j < times.length; j++) {\n\t\t\tvar value = poses[j].get(dofName);\n\t\t\tdataNew.append(times[j], value);\n\t\t}\n\t\tmotion.addTrack(new MotionTrack(dofName, dataNew, duration));\n\t}\n\n\treturn motion;\n};\nmodule.exports = Motion;"],"sourceRoot":"/source/"}